
\section{Related Work}
\textbf{Public Traffic Datasets.} There are several public traffic datasets which are frequently used for traffic prediction. They can be briefly categorized into three classes by spatial domain, which are \textbf{grid-based}, \textbf{sensor-based} and \textbf{road-network-based}.

For grid-based datasets, there are TaxiBJ\cite{taxibj} that consists of the taxi in and out flow data in Beijing, and TaxiNYC for taxis in New York City published by the New York City Taxi and Limousine Commission (TLC). Another widely used dataset is BikeNYC which is provided by the offical bike sharing system of NYC, including the starting and ending stations and travel time, etc. For sensor-based datasets, METR-LA\cite{DCRNN} and PEMS-BAY are the most frequently used datasets in urban traffic prediction area. In detail, METR-LA is the traffic data of Los Angeles that collected from 207 highway sensors for 4 months. PEMS-BAY is collected from 325 sensors all over the Bay Area of California for every 5 minutes. The traffic sensors can directly record the traffic flow and speed of each road, which makes the dataset easy to handle and process. And for road-network-based datasets, Didi GAIA's open data contains the GPS locations of DiDi Express and DiDi Premier drivers. The cities include Chengdu, Xi'an and Haikou. They have good qualities, but they are seldom applied to build a model. The GPS data contains taxi locations and timestamp that collected by Didi company's mobile app, which is similar to ours. In conclusion, as suggested by Jiang and Luo\cite{surveyGNN}, most traffic prediction models are built upon traffic sensor datasets, while road-network-based datasets are mainly used for test. Therefore, we need to make better use of it.

\vspace{\baselineskip}

\textbf{Road Network Modeling.} Road network is the basic component of urban traffic system. Except for traffic state prediction, there are a variety of applications develop on it, such as travel time estimation\cite{tte}, travel route recommendation\cite{route_recommend} and destination prediction\cite{dest_pred}. The problem of how to make a numerical representation of a graph has long been a hot research area in graph theories. To represent the non-euclidean information, many approaches have been proposed. Classical graph embedding methods are targeting at reducing the dimension of high-dimensional graph data into a lower dimensional representation while preserving the desired properties of the original data. For example, Principal Component Analysis (PCA)\cite{PCA}, Linear Discriminant Analysis (LDA)\cite{LDA} and Multidimensional Scaling (MDS)\cite{MDS}. Later, statistical models are used to represent road network, such as Hidden Markov Models\cite{HMMM} that used to model the location transitions over the road networks. For recent traffic prediction papers, Li et al.\cite{AAAI21} model road transition as a Markov Process over road network and use a first order Markov matrix to represent it. The random-walk-based graph embedding algorithms including DeepWalk\cite{deepwalk} and node2vec\cite{node2vec} utilize random walks to learn node representations. They sample many random paths over the graph. These paths indicate the context of connected nodes. The randomness of walks gives the ability to explore the graph and capture both the global and the local structural information by walking through neighbors. Then, probability models like skip-gram\cite{sg} can be applied to learn node representations. The growth of deep learning models makes it possible to model more complex road network and learn graph representation efficiently, including GCN\cite{GCN0}, GraphSAGE\cite{graphsage}, GAT\cite{GAT} and other types of networks. Lately, Wu et al.\cite{roadrep} proposed a hierarchical graph neural networks to capture both structural and functional characteristics of road network through several pre-defined attributes of each road. Wu et al.\cite{GWNET} use graph convolution to learn an adaptive adjacency matrix of road network graph, which is quite related to our work. To conclude, the two methods mentioned above need prior knowledge or learned end-to-end through stochastic gradient descent. In contrast, our work is to learn a representation of each road in advance to model its spatial characteristics only by trajectories and use it in traffic state prediction.

\vspace{\baselineskip}

\textbf{Traffic Prediction Models.} Early attempts use traditional time series forecasting model including ARIMA\cite{ARIMA_pred} and VAR\cite{var_pred}, as well as machine learning techniques like k-NN\cite{knn_pred} and SVM\cite{svm_pred}. Later, Recurrent Neural Networks (RNN)\cite{LSTM} and its variants such as  Long-Short-Term-Memory (LSTM)\cite{LSTM} and Gated Recurrent Unit (GRU)\cite{GRU} have been applied to learn from traffic state sequences. However, these models treat traffic sequences from different roads as independent data streams, being unable to utilize the spatial information in the road network graph. Many state-of-the-art deep neural networks have been proposed in the last several years. They combine the recurrent neural networks and graph neural networks to model the spatiotemporal dependency in traffic data. Yu et al.\cite{STGCN} proposed two different convolution blocks to capture spatial and temporal dependencies separately. Li et al.\cite{DCRNN} take advantage of seq2seq\cite{seq2seq} architecture and perform diffusion convolution on the graph. From our observation, few existing work leverage trajectories in traffic prediction. Hui et al.\cite{trajnet} extract the temporal features of roads by convolution with recent, daily-periodic and weekly-periodic traffic state data. Then they perform feature smoothing by propagating features through trajectories. On the contrary, our work attempts to combine the spatial representation that learned from trajectories into traffic state prediction models.
